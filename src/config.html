<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="Author" content="xiaomai" />
  <meta name="Keywords" content="HTML,model,test" />
  <meta name="Description" content="special effect model" />
  <meta name="time" content="2019-02-18" />
  <meta name="renderer" content="webkit" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0" />
  <title>VI配置</title>
  <link rel="stylesheet" href="css/ui.core.css" />
  <link rel="stylesheet" href="css/ui.layout.css" />
  <link rel="stylesheet" href="css/ui.button.css" />
  <link rel="stylesheet" href="css/ui.pagitor.css" />
  <link rel="stylesheet" href="css/ui.table.css" />
  <link rel="stylesheet" href="css/ui.check-radio.css" />
  <link rel="stylesheet" href="css/ui.page.css" />
  <script src="js/jquery.min.js"></script>
  <script src="js/core.js"></script>
  <script src="js/core.checkbox.js"></script>
  <script src="js/core.dialog.js"></script>
  <style>
    .container {
      padding: 2rem;
    }

    .col-4 {
      padding: 0 20px;
    }

    .col-4 label {
      line-height: 2;
      color: #925a5a;
    }

    input,
    textarea {
      border-radius: 3px;
    }
  </style>
</head>

<body>
  <div class="container">
    <pre>
获取所有input生成 var.less文件
    data-var是变量名
    value是变量值
    data-comment是样式注释
</pre>
    <textarea id="all" class="txt-mul" rows="10">
/*
时间：2017-5-19 14:03:46
说明：less变量文件
*/
</textarea>
    <h1><input class="check-all" name="part[]" type="checkbox" text="全选" /></h1>
    <p>通过 Less 变量可以自定义颜色、尺寸等，最终将会反映到下载的 less 样式表文件中。</p>

    <div data-part="less-color" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="颜色" text="1.颜色colors" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>gray灰色和baseColor主题色，贯穿全局的颜色</p>
    </div>

    <div data-part="less-global" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="脚手架scaffolding" text="2.全局样式" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>基本会用到的全局样式</p>
    </div>

    <div data-part="less-typography" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="排版Typography" text="3.排版Typography" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>body text和heading的字体 行高 颜色待定</p>
    </div>

    <div data-part="less-icon" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="icon图标" text="4.icon图标" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>路径 字体名待定</p>
    </div>

    <div data-part="less-component" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="组件components" text="5.组件components" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>定义通用的padding、border-radius以及组件active时的颜色、背景色</p>
    </div>

    <div data-part="less-button" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="按钮buttons" text="6.按钮buttons" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>背景 边框</p>
    </div>

    <div data-part="less-table" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="表格tables" text="7.表格tables" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>待定</p>
    </div>

    <div data-part="less-page" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="管理系统页面" text="8.page" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>query/info/list/form</p>
    </div>

    <div data-part="less-dropdown" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="下拉框dropdown" text="9.下拉框dropdown" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>menu和content</p>
    </div>

    <div data-part="less-layout" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="布局 包含栅格系统" text="10.布局" /> <button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>包含栅格系统</p>
    </div>
    <div data-part="less-notify" class="row clearfix">
      <h2><input name="part[]" type="checkbox" data-comment="loading与toast" text="11.notify提示" /><button
          class="btn btn-add-cross">&nbsp;</button></h2>
      <p>loading与toast</p>
    </div>
    <br />
    <div class="dialog-add">
      <br />
      <table class="table">
        <colgroup>
          <col width="100" />
          <col />
        </colgroup>
        <tr>
          <td class="txt-right">变量名</td>
          <td>
            <input class="txt" id="txtVarName" />
          </td>
        </tr>
        <tr>
          <td class="txt-right">变量值</td>
          <td>
            <input class="txt" id="txtVarValue" />
          </td>
        </tr>
        <tr>
          <td class="txt-right">注释</td>
          <td>
            <input class="txt" id="txtVarComment" />
          </td>
        </tr>
        <tr>
          <td></td>
          <td>
            <button class="btn" onclick="dlgAdd.Close(true);">确定</button>
            <button class="btn cancel" onclick="dlgAdd.Close(false);">取消</button>
          </td>
        </tr>
      </table>
    </div>
    <div>
      <input class="check-all" name="part[]" type="checkbox" text="全选" />
    </div>
    <button id="btnJson" class="btn">下载数据JSON</button>
    <button id="btnDown" class="btn">下载vi.less</button>
  </div>
  <script>
    $('[type="checkbox"]').iCheck();
    //新增less变量对话框
    var dlgAdd = $.dialog({
      title: "添加变量",
      size: { width: 400, height: 300 },
      selector: ".dialog-add"
    });
    $(dlgAdd.oView).append($('.dialog-add'));
    //新增less变量
    $('.btn-add-cross').click(function () {
      var that = $(this);
      dlgAdd.Open({
        Closed: function (isConfirm) {
          var o = {
            key: '@' + $('#txtVarName').val(),
            value: $('#txtVarValue').val()
          };
          var comment = $('#txtVarComment').val();
          if (comment) {
            o.comment = comment;
          }
          var odiv = that.parent().parent(),
            opart = odiv.attr('data-part').substring(5);
          datas[opart].push(o);
          odiv.append(createItems(o));
        }
      });
    });
    //查看json数据
    $('#btnJson').click(function () {
      $.download('data.json', JSON.stringify(datas));
    });
    //下载less文件
    $("#btnDown").click(function () {
      var vars = {};
      var res = "";
      //div 
      $('div[data-part]').each(function () {
        var self = $(this);
        var oipt = self.find('input[name="part[]"]');
        var flag = oipt.prop('checked');
        if (!flag) {
          return;
        }
        self.find('input').each(function () {
          var self2 = $(this);
          if (self2.attr('type') === 'checkbox' && !self2.prop('checked')) {
            return;
          }
          if (self2.attr('data-comment')) {
            res += '\n//' + self2.attr('data-comment') + '\n';
          }
          if (self2.attr('data-var') && self2.val()) {
            res += self2.attr('data-var') + ": " + self2.val() + ';\n';
          }
          vars[self2.attr('data-var')] = self2.val();

        });
      });
      //console.log($('#all').val() + res);
      $.download('vi.less', $('#all').val() + res);
    });
    //根据json创建一个less变量的UI
    function createItems(v) {
      var odiv = $.createNode("div", { "class": "col-4" });
      var olabel = $.createNode("label", { "for": "input-" + v.key }, v.key);
      var oinput = $.createNode("input", { "id": "input-" + v.key, "class": "txt", "data-var": v.key }, v.value);
      if (v.readonly) {
        $(oinput).attr('readonly', v.readonly);
      }
      if (v.disabled) {
        $(oinput).attr('disabled', v.disabled);
      }
      if (v.comment) {
        $(oinput).attr({ 'data-comment': v.comment });
        $(olabel).attr({ 'title': v.comment });
      }
      odiv.appendChild(olabel);
      odiv.appendChild(oinput);
      return odiv;
    }
    var datas = {
      'color': [
        { key: "@gray-base", value: "#CCC", comment: "边框灰度" },
        { key: "@gray-dark", value: "#333", comment: "文字灰度" },
        { key: "@gray-light", value: "#F0F0F0", comment: "背景灰度" },
        { key: "@color-primary", value: "#0F88EB", comment: "项目全局主色调" },
        { key: "@color-success", value: "#5CB85C" },
        { key: "@color-info", value: "@color-primary" },
        { key: "@color-warning", value: "#F0AD4E" },
        { key: "@color-error", value: "#D9535F" }
      ],
      'global': [
        { key: "@body-bg", value: "#FFF" },
        { key: "@body-text-color", value: "@gray-dark" },
        { key: "@body-font-size", value: "14px" },
        { key: "@link-color", value: "@body-text-color" },
        { key: "@link-hover-color", value: "lighten(@link-color, 15%)" },
        { key: "@link-active-color", value: "#F00" }
      ],
      'icon': [],
      'typography': [],
      'component': [
        { key: "@component-padding-vertical", value: "6px" },
        { key: "@component-padding-horizontal", value: "12px" },
        { key: "@component-border-radius", value: "4px" },
        { key: "@component-border-color", value: "@gray-base" },
        { key: "@component-bg", value: "@gray-light" },
        { key: "@component-caret-width", value: "4px", comment: "下拉框三角" }
      ],
      'button': [
        { key: "@btn-disabled-color", value: "@gray-dark" },
        { key: "@btn-disabled-border-color", value: "@component-border-color" },
        { key: "@btn-disabled-bg", value: "@component-bg" },
        { key: "@btn-padding-vertical", value: "@component-padding-vertical" },
        { key: "@btn-padding-horizontal", value: "@component-padding-horizontal" },
        { key: "@btn-radius", value: "@component-border-radius" },
      ],
      'table': [
        { key: "@table-border-color", value: "@component-border-color" },
        { key: "@table-top-bg", value: "@component-bg" },
        { key: "@table-top-color", value: "@gray-base" },
        { key: "@table-odd-bg", value: "#FFF" },
        { key: "@table-even-bg", value: "@gray-light" },
        { key: "@table-hover-bg", value: "#CCC" },
        { key: "@table-padding-horizontal", value: "@component-padding-horizontal" },
        { key: "@table-padding-vertical", value: "@component-padding-vertical" },
      ],
      'page': [
        { key: "@page-query-bg", value: "@component-bg" },
        { key: "@page-info-bg", value: "lighten(@gray-light,5%)" },
        { key: "@page-info-border", value: "@component-border-color" },
        { key: "@page-info-title-bg", value: "@component-bg" },
        { key: "@page-list-top-bg", value: "@component-bg" },
        { key: "@page-list-top-color", value: "@component-bg" },
        { key: "@page-list-odd-bg", value: "@component-bg" },
        { key: "@page-list-even-bg", value: "@component-bg" },
        { key: "@page-list-padding-horizontal", value: "@component-bg" },
        { key: "@page-list-padding-vertical", value: "@component-bg" }
      ],
      'dropdown': [
        { key: "@dropdown-bg", value: "#FFF" },
        { key: "@dropdown-active-bg", value: "#FFF" }
      ],
      'layout': [
        { key: "@grid-columns", value: "12" },
        { key: "@grid-offset", value: "20" }
      ],
      'notify': [
        { key: "@notify-bg", value: "#666", disabled: true }
      ]
    };
    for (var k in datas) {
      datas[k].forEach(function (item) {
        $("[data-part='less-" + k + "']").append(createItems(item));
      });
    }

  </script>
</body>

</html>